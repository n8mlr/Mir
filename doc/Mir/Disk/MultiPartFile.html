<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Mir::Disk::MultiPartFile
  
    &mdash; Documentation by YARD 0.7.2
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (M)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../Mir.html" title="Mir (module)">Mir</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Disk.html" title="Mir::Disk (module)">Disk</a></span></span>
     &raquo; 
    <span class="title">MultiPartFile</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Mir::Disk::MultiPartFile
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Mir::Disk::MultiPartFile</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/mir/disk/amazon.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
Used to hide the inner details of multipart file uploads and downloads. It
is important that this class does not throw any exceptions as these
exceptions may be swallowed further up the stack by worker threads
</p>


  </div>
</div>
<div class="tags">
  
</div>

  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#disk-instance_method" title="#disk (instance method)">- (Object) <strong>disk</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the value of attribute disk.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#name-instance_method" title="#name (instance method)">- (Object) <strong>name</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the value of attribute name.
</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get-instance_method" title="#get (instance method)">- (Object) <strong>get</strong>(dest) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Downloads the resource to the destination.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (MultiPartFile) <strong>initialize</strong>(disk, name) </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
A new instance of MultiPartFile.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#multipart%3F-instance_method" title="#multipart? (instance method)">- (Boolean) <strong>multipart?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Whether the resource is broken into chunks on the remote store.
</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Mir::Disk::MultiPartFile (class)">MultiPartFile</a></span></tt>) <strong>initialize</strong>(disk, name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
A new instance of MultiPartFile
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>the</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Disk.html" title="Mir::Disk (module)">Disk</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
remote disk
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>the</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
name of the resource
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


238
239
240
241
242
243
244
245
246
247
248
249</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mir/disk/amazon.rb', line 238</span>

<span class='kw'>def</span> <span class='id initialize'>initialize</span><span class='lparen'>(</span><span class='id disk'>disk</span><span class='comma'>,</span> <span class='id name'>name</span><span class='rparen'>)</span>
  <span class='ivar'>@disk</span><span class='comma'>,</span> <span class='ivar'>@name</span> <span class='op'>=</span> <span class='id disk'>disk</span><span class='comma'>,</span> <span class='id name'>name</span>
  <span class='id multiname'>multiname</span> <span class='op'>=</span> <span class='const'>Utils</span><span class='period'>.</span><span class='id filename_with_sequence'>filename_with_sequence</span><span class='lparen'>(</span><span class='id name'>name</span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span>
            
  <span class='kw'>if</span> <span class='id disk'>disk</span><span class='period'>.</span><span class='id key_exists?'>key_exists?</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span>
    <span class='ivar'>@multipart</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>elsif</span> <span class='id disk'>disk</span><span class='period'>.</span><span class='id key_exists?'>key_exists?</span><span class='lparen'>(</span><span class='id multiname'>multiname</span><span class='rparen'>)</span>
    <span class='ivar'>@multipart</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>else</span>
    <span class='id raise'>raise</span> <span class='const'>Disk</span><span class='op'>::</span><span class='const'>RemoteFileNotFound</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <span id="disk-instance_method"></span>
      <div class="method_details first">
  <p class="signature first" id="disk-instance_method">
  
    - (<tt>Object</tt>) <strong>disk</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the value of attribute disk
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


251
252
253</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mir/disk/amazon.rb', line 251</span>

<span class='kw'>def</span> <span class='id disk'>disk</span>
  <span class='ivar'>@disk</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="name-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="name-instance_method">
  
    - (<tt>Object</tt>) <strong>name</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the value of attribute name
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


251
252
253</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mir/disk/amazon.rb', line 251</span>

<span class='kw'>def</span> <span class='id name'>name</span>
  <span class='ivar'>@name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="get-instance_method">
  
    - (<tt>Object</tt>) <strong>get</strong>(dest) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Downloads the resource to the destination. If the file is stored in parts
it is download sequentially in pieces
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mir/disk/amazon.rb', line 260</span>

<span class='kw'>def</span> <span class='id get'>get</span><span class='lparen'>(</span><span class='id dest'>dest</span><span class='rparen'>)</span>
  <span class='id output'>output</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id dest'>dest</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>wb</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>begin</span>
    <span class='kw'>if</span> <span class='id multipart?'>multipart?</span>
      <span class='id seq'>seq</span> <span class='op'>=</span> <span class='int'>1</span>
      <span class='kw'>while</span> <span class='id part'>part</span> <span class='op'>=</span> <span class='const'>Utils</span><span class='period'>.</span><span class='id filename_with_sequence'>filename_with_sequence</span><span class='lparen'>(</span><span class='id name'>name</span><span class='comma'>,</span> <span class='id seq'>seq</span><span class='rparen'>)</span> <span class='kw'>do</span>
        <span class='kw'>break</span> <span class='kw'>unless</span> <span class='id disk'>disk</span><span class='period'>.</span><span class='id key_exists?'>key_exists?</span> <span class='id part'>part</span>
        <span class='id output'>output</span><span class='period'>.</span><span class='id write'>write</span> <span class='id disk'>disk</span><span class='period'>.</span><span class='id read'>read</span><span class='lparen'>(</span><span class='id part'>part</span><span class='rparen'>)</span>
        <span class='id seq'>seq</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id output'>output</span><span class='period'>.</span><span class='id write'>write</span> <span class='id disk'>disk</span><span class='period'>.</span><span class='id read'>read</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id e'>e</span>
    <span class='const'>Mir</span><span class='period'>.</span><span class='id logger'>logger</span><span class='period'>.</span><span class='id error'>error</span> <span class='id e'>e</span>
  <span class='kw'>ensure</span>
    <span class='id output'>output</span><span class='period'>.</span><span class='id close'>close</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="multipart?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>multipart?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Whether the resource is broken into chunks on the remote store
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


254
255
256</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mir/disk/amazon.rb', line 254</span>

<span class='kw'>def</span> <span class='id multipart?'>multipart?</span>
  <span class='ivar'>@multipart</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Fri Sep 23 18:24:38 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.2 (ruby-1.9.2).
</div>

  </body>
</html>